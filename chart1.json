{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Australia's Renewable Energy vs Emissions Trends (2010–2025)",
  "width": 1120,
  "height": 500,
  "background": "#f8fafc",

  "config": {
    "background": "#f8fafc",
    "style": {
      "guide-label": { "color": "#1e293b" },
      "guide-title": { "color": "#1e293b" }
    },
    "axis": {
      "gridColor": "#e2e8f0",
      "labelColor": "#64748b",
      "titleColor": "#64748b"
    },
    "legend": {
      "labelColor": "#1e293b",
      "titleColor": "#1e293b",
      "orient": "top-right",
      "fillColor": "#ffffff",
      "strokeColor": "#e2e8f0",
      "cornerRadius": 6
    }
  },

  "data": {
    "url": "https://raw.githubusercontent.com/achikins/FIT3179_DataVisualisation_2_34082034/main/data/Renewable_Share_By_State_2010_2025.csv"
  },

  "transform": [
    { "calculate": "toNumber(datum.Year)", "as": "YearNum" },
    {
      "aggregate": [
        {
          "op": "mean",
          "field": "Renewable_Share (%)",
          "as": "Avg_Renewable_Share"
        },
        { "op": "sum", "field": "Total_GWh", "as": "Total_Generation" },
        { "op": "sum", "field": "Renewable_GWh", "as": "Total_Renewable_GWh" }
      ],
      "groupby": ["YearNum"]
    },
    {
      "calculate": "datum.Total_Renewable_GWh / datum.Total_Generation * 100",
      "as": "Weighted_Renewable_Share"
    },
    {
      "lookup": "YearNum",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/achikins/FIT3179_DataVisualisation_2_34082034/main/data/nggi_emissions_2010_2025.csv"
        },
        "key": "Year ",
        "fields": ["Average of Trend Emissions"]
      }
    },
    {
      "fold": ["Weighted_Renewable_Share", "Average of Trend Emissions"],
      "as": ["Metric", "Value"]
    }
  ],

  "layer": [
    {
      "mark": { "type": "line", "interpolate": "monotone", "strokeWidth": 3 },
      "encoding": {
        "x": {
          "field": "YearNum",
          "type": "ordinal",
          "axis": { "title": "Year" }
        },
        "y": {
          "field": "Value",
          "type": "quantitative",
          "axis": {
            "title": "Renewable Share (%)",
            "scale": { "domain": [20, 60] }
          }
        },
        "color": { "value": "#2E8B57" },
        "strokeDash": {
          "field": "Metric",
          "type": "nominal",
          "scale": {
            "domain": [
              "Weighted_Renewable_Share",
              "Average of Trend Emissions"
            ],
            "range": [[], [4, 3]]
          }
        },
        "tooltip": [
          { "field": "YearNum", "type": "ordinal", "title": "Year" },
          { "field": "Metric", "type": "nominal", "title": "Type" },
          {
            "field": "Value",
            "type": "quantitative",
            "format": ".2f",
            "title": "Value"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "line",
        "interpolate": "monotone",
        "strokeWidth": 3,
        "opacity": 0.7
      },
      "encoding": {
        "x": {
          "field": "YearNum",
          "type": "ordinal"
        },
        "y": {
          "field": "Value",
          "type": "quantitative",
          "axis": {
            "title": "Emissions (Mt CO₂-e)",
            "orient": "right",
            "scale": { "domain": [150, 200] }
          }
        },
        "color": { "value": "#DC143C" },
        "strokeDash": {
          "field": "Metric",
          "type": "nominal",
          "scale": {
            "domain": [
              "Weighted_Renewable_Share",
              "Average of Trend Emissions"
            ],
            "range": [[], [4, 3]]
          }
        }
      }
    }
  ],

  "resolve": {
    "scale": {
      "y": "independent"
    }
  },

  "title": {
    "text": "Renewable Energy Share vs Electricity Sector Emissions (2010 - 2025)",
    "color": "#1e293b",
    "fontSize": 25,
    "anchor": "start"
  }
}
