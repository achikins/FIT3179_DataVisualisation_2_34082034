{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Chart 2 — Interactive Choropleth Map of Renewable Share by Australian State (2010–2025)",
  "width": 700,
  "height": 500,
  "background": "#f8fafc",
  
  "config": {
    "background": "#f8fafc",
    "view": {"stroke": "transparent"},
    "legend": {"labelColor": "#1e293b", "titleColor": "#1e293b"},
    "style": {"guide-label": {"color": "#1e293b"}}
  },
  
  "params": [
    {
      "name": "selectedYear",
      "value": 2025,
      "bind": {
        "input": "range",
        "min": 2010,
        "max": 2025,
        "step": 1,
        "name": "Select Year:"
      }
    }
  ],
  
  "data": {
    "url": "https://raw.githubusercontent.com/achikins/FIT3179_DataVisualisation_2_34082034/main/data/aus_states.topojson",
    "format": {"type": "topojson", "feature": "ne_10m_admin_1_states_provinces"}
  },
  
  "transform": [
    {
      "lookup": "properties.postal",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/achikins/FIT3179_DataVisualisation_2_34082034/main/data/Renewable_Share_By_State_2010_2025.csv"
        },
        "key": "State",
        "fields": ["Year", "Renewable_Share (%)"]
      }
    },
    {
      "calculate": "toNumber(datum.Year)",
      "as": "YearNum"
    },
    {
      "calculate": "datum.YearNum == selectedYear ? datum['Renewable_Share (%)'] : 0",
      "as": "Renewable_Share_Display"
    }
  ],
  
  "projection": {
    "type": "mercator",
    "center": [135, -28],
    "scale": 1000
  },
  
  "mark": {
    "type": "geoshape",
    "stroke": "#cbd5e1",
    "strokeWidth": 1.2
  },
  
  "encoding": {
    "color": {
      "field": "Renewable_Share_Display",
      "type": "quantitative",
      "title": "Renewable Share (%)",
      "scale": {
        "domain": [0, 100],
        "range": ["#f0f0f0", "#bae4b3", "#74c476", "#31a354", "#006d2c"]
      },
      "legend": {
        "orient": "right",
        "titleFontSize": 13,
        "labelFontSize": 11,
        "gradientLength": 200
      }
    },
    "tooltip": [
      {"field": "properties.name", "type": "nominal", "title": "State"},
      {"field": "Renewable_Share_Display", "type": "quantitative", "format": ".1f", "title": "Renewable Share (%)"},
      {"field": "YearNum", "type": "ordinal", "title": "Year"}
    ]
  },
  
  "title": {
    "text": "Interactive Choropleth Map — Renewable Share by State (2010–2025)",
    "color": "#1e293b",
    "fontSize": 18,
    "anchor": "start"
  }
}
